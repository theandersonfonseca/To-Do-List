(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var e=function(){function e(t,n,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.LIST_ID=a,this.listName="",this.TASK_ID=1,this.status="incomplete",this.container=t,this.inputTask=n,this.tasksList=[]}var n,a;return n=e,(a=[{key:"saveInLocalStorage",value:function(){localStorage.setItem("".concat(this.LIST_ID),JSON.stringify(this))}},{key:"updateDom",value:function(){this.container.innerHTML="";var t=this.tasksList.reduce((function(t,e){var n,a,i,s;return t+"".concat((a=(n=e).TASK_ID,i=n.description,s=n.status,'\n                    <div class=" '.concat("complete"===s?"tasks__task tasks__task--complete":"tasks__task",'" data-id="').concat(a,'">\n                      <div class="tasks__check" data-complete-task>\n                        <i class="tasks__check-icon far fa-check" ></i>\n                      </div>\n                      <p class="tasks__description">').concat(i,'</p>\n                      <div class="tasks__controls">\n                        <i class="tasks__edit fas fa-edit" data-edit-task></i>\n                        <i class="tasks__trash fas fa-trash" data-remove-task></i>\n                      </div>\n                    </div>\n                   ')))}),"");this.container.innerHTML=t}},{key:"addTask",value:function(t){this.tasksList.push({TASK_ID:this.TASK_ID,description:t,status:this.status}),this.updateDom(),this.incrementID()}},{key:"incrementID",value:function(){this.TASK_ID+=1}},{key:"removeTask",value:function(t){this.tasksList=this.tasksList.filter((function(e){return e.TASK_ID!==t})),this.updateDom()}},{key:"completeTask",value:function(t){var e=this.tasksList.findIndex((function(e){return e.TASK_ID===t}));this.tasksList[e].status="incomplete"===this.tasksList[e].status?"complete":"incomplete",this.updateDom()}},{key:"editTask",value:function(t,e){var n=this.tasksList.findIndex((function(e){return e.TASK_ID===t}));this.tasksList[n].description=e,this.updateDom()}},{key:"removeCompleteTasks",value:function(){this.tasksList=this.tasksList.filter((function(t){return"incomplete"===t.status})),this.updateDom()}}])&&t(n.prototype,a),e}(),n=function(t){return document.querySelector(t)},a=function(t){return document.querySelectorAll(t)},i=function(t,e){return t.addEventListener("click",e)},s=function(t){return!(t.trim().length<1)},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector("[data-input-task]");t.value=""},o=function(t){t.forEach((function(t){"none"===t.style.display?t.style.display="block":t.style.display="none"}))};var c=n("[data-input-task]"),u=n("[data-add-task]"),l=n("[data-remove-complete]"),d=n("[data-tasks-container]"),f=n("[data-new-list]"),m=n("[data-new-list-form]"),v=n("[data-list-options]"),p=n("[data-new-list-input]"),k=n("[data-select]"),h=n("[data-remove-controls]"),L=n("[data-remove-list]"),_="controls__lists--new-task",y=function(t){var e=document.createElement("option");return e.classList.add("controls__option"),e.value=t,e.setAttribute("data-option","".concat(t)),e.innerHTML=t,e};function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var I,T,D=[],g=1;(T=new e(d,c,g)).listName="main",D.push(T),I=T;var b,w,E=function(){var t,e=function(t){if(Array.isArray(t))return S(t)}(t=D)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();I=e[0],k.value="main",I.updateDom()},N=function(){var t=D.findIndex((function(t){return t.LIST_ID===I.LIST_ID}));D[t]=I},A=function(){localStorage.setItem("lists",JSON.stringify(D))},K=function(t,e){var n="remove-controls--default-list";return"add"===e?t.classList.add(n):t.classList.remove(n)},C=function(t){var n=new e(d,c,g+=1);return I=n,n.listName=p.value,D.push(n),n.updateDom(),N(),A(),t(n),n};b=function t(){a("[data-remove-task]").forEach((function(e){return i(e,(function(e){!function(t,e,n){var a=+t.target.parentNode.parentNode.dataset.id;e.removeTask(a),n()}(e,I,t)}))})),a("[data-complete-task]").forEach((function(e){return i(e,(function(e){return function(t,e,n){var a=+t.target.parentNode.dataset.id;e.completeTask(a),n()}(e,I,t)}))})),a("[data-edit-task]").forEach((function(e){return i(e,(function(e){!function(t,e,n){var a=+t.target.parentNode.parentNode.dataset.id,i=t.target.parentNode.parentNode,r=t.target.parentNode.previousElementSibling,c=r.previousElementSibling,u=r.nextElementSibling.children[0],l=r.nextElementSibling.children[1];o([c,u,l]);var d,f=((d=document.createElement("form")).classList.add("controls__tasks-edit"),d.innerHTML=' <input\n                        data-input-task\n                        class="controls__input-edit"\n                        type="text"\n                        placeholder="Descreva a tarefa..."\n                      />\n                      ',d),m=f.children[0];i.replaceChild(f,r),m.focus();var v=function t(){document.activeElement!==m&&(s(m.value)&&e.editTask(a,m.value),o([c,u,l]),e.updateDom(),n(),window.removeEventListener("click",t))};window.addEventListener("click",v),i.addEventListener("submit",(function(t){if(t.preventDefault(),!s(m.value))return o([c,u,l]),e.updateDom(),n(),void window.removeEventListener("click",v);e.editTask(a,m.value),o([c,u,l]),n(),window.removeEventListener("click",v)}))}(e,I,t)}))})),N(),A()},w=function(t){"main"===t.listName?K(h,"add"):K(h,"remove"),L.addEventListener("click",(function(t){t.stopImmediatePropagation(),D=D.filter((function(t){return t.LIST_ID!==I.LIST_ID})),document.querySelector('[data-option="'.concat(I.listName,'"]')).remove(),K(h,"add"),A(),E(),b()}))},i(u,(function(t){!function(t,e,n){t.preventDefault();var a=c.value;s(a)&&(e.addTask(a),c.focus(),n(),r())}(t,I,b)})),i(l,(function(){!function(t,e){t.removeCompleteTasks(),e()}(I,b)})),i(f,(function(){!function(t,e){v.classList.add(_),m.addEventListener("submit",(function(n){return function(t,e,n){if(t.preventDefault(),"cancel"===t.submitter.dataset.cancelNewList||!s(p.value))return v.classList.remove(_),void r(p);var a=y(p.value);k.appendChild(a),e(n),c.focus(),v.classList.remove(_),k.value=a.value,r(p)}(n,t,e)})),p.focus()}(C,w)})),k.addEventListener("change",(function(t){var e=D.find((function(e){return e.listName===t.target.value}));e.updateDom(),I=e,w(e),b()})),function(t){localStorage.lists&&(D=(D=JSON.parse(localStorage.getItem("lists"))).map((function(t){var n=t.listName,a=t.tasksList,i=t.TASK_ID;return function(t,e,n,a){t.listName=e,t.tasksList=n,t.TASK_ID=a,"main"!==t.listName&&k.appendChild(y(t.listName))}(t=new e(d,c,g),n,a,i),g+=1,t})),E(),t())}(b)})();